<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å…±ç«‹è£½è–¬ ã‚¹ã‚³ã‚¢ã‚·ãƒ¼ãƒˆDX - ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React & ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- SheetJS for Excel export -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Noto Sans JP', 'Inter', 'sans-serif'],
            mono: ['Inter', 'monospace'],
          },
          colors: {
            primary: {
              50: '#eff6ff',
              100: '#dbeafe',
              200: '#bfdbfe',
              300: '#93c5fd',
              400: '#60a5fa',
              500: '#3b82f6',
              600: '#1d4ed8',
              700: '#1e40af',
              800: '#1e3a8a',
              900: '#172554',
            },
            confidence: {
              high: '#059669',
              medium: '#d97706',
              low: '#dc2626',
            }
          }
        }
      }
    }
  </script>

  <style>
    * {
      font-family: 'Noto Sans JP', 'Inter', sans-serif;
    }

    .mono {
      font-family: 'Inter', monospace;
    }

    /* Subtle animation */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate-fade-in {
      animation: fadeIn 0.3s ease-out forwards;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }

    /* Dropzone styling */
    .dropzone-active {
      border-color: #3b82f6 !important;
      background-color: #eff6ff !important;
    }

    /* Confidence badge pulse */
    .confidence-pulse {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
  </style>
</head>
<body class="bg-slate-50 min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // ============================================================
    // EXCEL EXPORT UTILITIES
    // ============================================================
    const ExcelExporter = {
      // Export history data to Excel
      exportHistory: (historyData, filename = "å‡¦ç†å±¥æ­´") => {
        const headers = ["ID", "æ—¥ä»˜", "æ™‚é–“", "å¯¾è±¡", "ä¿¡é ¼åº¦", "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"];
        const rows = historyData.map(item => [
          item.id,
          item.date,
          item.time,
          item.animal,
          `${item.confidence}%`,
          item.status
        ]);

        const ws = XLSX.utils.aoa_to_sheet([headers, ...rows]);

        // Set column widths
        ws['!cols'] = [
          { wch: 20 }, // ID
          { wch: 12 }, // æ—¥ä»˜
          { wch: 8 },  // æ™‚é–“
          { wch: 18 }, // å¯¾è±¡
          { wch: 10 }, // ä¿¡é ¼åº¦
          { wch: 10 }, // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
        ];

        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "å‡¦ç†å±¥æ­´");

        const now = new Date();
        const dateStr = `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}`;
        XLSX.writeFile(wb, `${filename}_${dateStr}.xlsx`);

        return true;
      },

      // Export scoresheet data to Excel (supports single or multiple records)
      // Input: single data object or array of data objects
      exportScoreSheet: (dataInput) => {
        const wb = XLSX.utils.book_new();

        // Convert single data to array for uniform processing
        const dataArray = Array.isArray(dataInput) ? dataInput : [dataInput];

        // è¦³å¯Ÿé …ç›®ã‚’0ï¼ˆæ­£å¸¸ï¼‰ã€1ï¼ˆè»½åº¦ï¼‰ã€2ï¼ˆé‡åº¦ï¼‰ã«å¤‰æ›ã™ã‚‹é–¢æ•°
        const toNumeric = (field, value) => {
          const valueMap = {
            appetite: {
              "è‰¯å¥½": 0,
              "æ®‹é¤Œ1/3ä»¥ä¸‹": 1,
              "æ®‹é¤Œ2/3ä»¥ä¸‹": 2,
              "é£Ÿã¹ãªã„": 2,
            },
            energy: {
              "å…ƒæ°—": 0,
              "ã‚„ã‚„å…ƒæ°—ãªã—": 1,
              "å…ƒæ°—ãªã—": 2,
              "ãã£ãŸã‚Š": 2,
            },
            dehydration: {
              "ãªã—": 0,
              "è»½åº¦": 1,
              "ä¸­åº¦": 2,
              "é‡åº¦": 2,
            },
            vomiting: {
              "ãªã—": 0,
              "ã‚ã‚Šï¼ˆ1å›ï¼‰": 1,
              "ã‚ã‚Šï¼ˆè¤‡æ•°å›ï¼‰": 2,
            },
            feces: {
              "æ™®é€š": 0,
              "è»Ÿä¾¿": 1,
              "ãªã—": 1,
              "ä¸‹ç—¢": 2,
              "è¡€ä¾¿": 2,
            },
            nasalDischarge: {
              "ãªã—": 0,
              "ã‚ã‚Šï¼ˆæ¼¿æ¶²æ€§ï¼‰": 1,
              "ã‚ã‚Šï¼ˆç²˜æ¶²æ€§ï¼‰": 2,
              "ã‚ã‚Šï¼ˆè†¿æ€§ï¼‰": 2,
            },
            lacrimation: {
              "ãªã—": 0,
              "ã‚ã‚Š": 1,
            },
            conjunctivitis: {
              "ãªã—": 0,
              "è»½åº¦": 1,
              "é‡åº¦": 2,
            },
            eyeDischarge: {
              "ãªã—": 0,
              "ã‚ã‚Š": 1,
            },
            cough: {
              "ãªã—": 0,
              "ã‚ã‚Šï¼ˆè»½åº¦ï¼‰": 1,
              "ã‚ã‚Šï¼ˆé‡åº¦ï¼‰": 2,
            },
            sneezing: {
              "ãªã—": 0,
              "ã‚ã‚Š": 1,
            },
            abnormalBreathing: {
              "ãªã—": 0,
              "ã‚ã‚Š": 1,
            },
          };
          return valueMap[field]?.[value] ?? 0;
        };

        // Define headers (1è¡Œç›®ã®ã‚«ãƒ©ãƒ )
        const headers = [
          "ID",
          "å¹´æœˆæ—¥",
          "æ™‚é–“",
          "ç®¡ç†è€…",
          "å‹•ç‰©ç¨®",
          "å€‹ä½“ID",
          "ç›´è…¸æ¸©(â„ƒ)",
          "ä½“é‡(kg)",
          "é£Ÿæ¬²",
          "å…ƒæ°—",
          "è„±æ°´",
          "å˜”å",
          "ç³ä¾¿",
          "é¼»æ±",
          "æµæ·š",
          "çµè†œç‚",
          "çœ¼è„‚",
          "ç™ºå’³",
          "ãã—ã‚ƒã¿",
          "å‘¼å¸éŸ³ç•°å¸¸",
        ];

        // Convert each data record to a row (2è¡Œç›®ä»¥é™ã®ãƒ‡ãƒ¼ã‚¿)
        // è¦³å¯Ÿé …ç›®ã¯0ï¼ˆæ­£å¸¸ï¼‰ã€1ï¼ˆè»½åº¦ï¼‰ã€2ï¼ˆé‡åº¦ï¼‰ã§å‡ºåŠ›
        const rows = dataArray.map(data => [
          data.id,
          data.basicInfo.date.value,
          data.basicInfo.time.value,
          data.basicInfo.manager.value,
          data.basicInfo.animalType.value,
          data.basicInfo.animalId.value,
          data.numericData.rectalTemp.value,
          data.numericData.weight.value,
          toNumeric('appetite', data.checkboxData.appetite.value),
          toNumeric('energy', data.checkboxData.energy.value),
          toNumeric('dehydration', data.checkboxData.dehydration.value),
          toNumeric('vomiting', data.checkboxData.vomiting.value),
          toNumeric('feces', data.checkboxData.feces.value),
          toNumeric('nasalDischarge', data.checkboxData.nasalDischarge.value),
          toNumeric('lacrimation', data.checkboxData.lacrimation.value),
          toNumeric('conjunctivitis', data.checkboxData.conjunctivitis.value),
          toNumeric('eyeDischarge', data.checkboxData.eyeDischarge.value),
          toNumeric('cough', data.checkboxData.cough.value),
          toNumeric('sneezing', data.checkboxData.sneezing.value),
          toNumeric('abnormalBreathing', data.checkboxData.abnormalBreathing.value),
        ]);

        // Create sheet with headers + data rows
        const ws = XLSX.utils.aoa_to_sheet([headers, ...rows]);

        // Set column widths
        ws['!cols'] = [
          { wch: 18 }, // ID
          { wch: 12 }, // å¹´æœˆæ—¥
          { wch: 8 },  // æ™‚é–“
          { wch: 12 }, // ç®¡ç†è€…
          { wch: 8 },  // å‹•ç‰©ç¨®
          { wch: 14 }, // å€‹ä½“ID
          { wch: 10 }, // ç›´è…¸æ¸©
          { wch: 10 }, // ä½“é‡
          { wch: 6 },  // é£Ÿæ¬²
          { wch: 6 },  // å…ƒæ°—
          { wch: 6 },  // è„±æ°´
          { wch: 6 },  // å˜”å
          { wch: 6 },  // ç³ä¾¿
          { wch: 6 },  // é¼»æ±
          { wch: 6 },  // æµæ·š
          { wch: 6 },  // çµè†œç‚
          { wch: 6 },  // çœ¼è„‚
          { wch: 6 },  // ç™ºå’³
          { wch: 8 },  // ãã—ã‚ƒã¿
          { wch: 10 }, // å‘¼å¸éŸ³ç•°å¸¸
        ];

        XLSX.utils.book_append_sheet(wb, ws, "ã‚¹ã‚³ã‚¢ã‚·ãƒ¼ãƒˆ");

        // Generate filename
        const now = new Date();
        const dateStr = `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}`;
        const filename = dataArray.length === 1
          ? `ã‚¹ã‚³ã‚¢ã‚·ãƒ¼ãƒˆ_${dataArray[0].id}.xlsx`
          : `ã‚¹ã‚³ã‚¢ã‚·ãƒ¼ãƒˆä¸€è¦§_${dateStr}.xlsx`;

        XLSX.writeFile(wb, filename);

        return filename;
      }
    };

    // ============================================================
    // TOAST NOTIFICATION
    // ============================================================
    const Toast = ({ message, type = "success", onClose }) => {
      useEffect(() => {
        const timer = setTimeout(onClose, 3000);
        return () => clearTimeout(timer);
      }, [onClose]);

      const bgColor = type === "success" ? "bg-emerald-600" : type === "error" ? "bg-red-600" : "bg-primary-600";
      const icon = type === "success" ? "âœ“" : type === "error" ? "âœ•" : "â„¹";

      return (
        <div className={`fixed bottom-6 right-6 ${bgColor} text-white px-6 py-4 rounded-lg shadow-lg flex items-center gap-3 animate-fade-in z-50`}>
          <span className="text-lg">{icon}</span>
          <span>{message}</span>
        </div>
      );
    };

    // ============================================================
    // ICONS (using Lucide via CDN)
    // ============================================================
    const Icon = ({ name, className = "w-5 h-5", ...props }) => {
      const ref = useRef(null);
      useEffect(() => {
        if (ref.current) {
          ref.current.innerHTML = '';
          lucide.createElement(lucide.icons[name]).then(el => {
            if (el && ref.current) {
              el.classList.add(...className.split(' '));
              ref.current.appendChild(el);
            }
          }).catch(() => {
            // Fallback for icons
            ref.current.innerHTML = `<span class="${className}">â—</span>`;
          });
        }
      }, [name, className]);
      return <span ref={ref} className="inline-flex items-center justify-center" {...props} />;
    };

    // Simple icon component using emoji fallbacks for reliability
    const SimpleIcon = ({ type, className = "" }) => {
      const icons = {
        upload: "ğŸ“¤",
        file: "ğŸ“„",
        check: "âœ“",
        alert: "âš ",
        search: "ğŸ”",
        download: "ğŸ“¥",
        calendar: "ğŸ“…",
        clock: "ğŸ•",
        user: "ğŸ‘¤",
        dog: "ğŸ•",
        cat: "ğŸˆ",
        thermometer: "ğŸŒ¡ï¸",
        weight: "âš–ï¸",
        grid: "â–¦",
        list: "â˜°",
        home: "ğŸ ",
        settings: "âš™ï¸",
        chevronRight: "â€º",
        x: "âœ•",
        plus: "+",
        minus: "-",
        edit: "âœï¸",
        save: "ğŸ’¾",
        refresh: "ğŸ”„",
      };
      return <span className={className}>{icons[type] || "â—"}</span>;
    };

    // ============================================================
    // SAMPLE DATA
    // ============================================================
    const sampleScoreSheetData = {
      id: "SS-2026-0120-001",
      basicInfo: {
        date: { value: "2026-01-20", confidence: 0.95 },
        time: { value: "14:30", confidence: 0.92 },
        manager: { value: "ç”°ä¸­å¤ªéƒ", confidence: 0.88 },
        animalType: { value: "çŠ¬", confidence: 0.99 },
        animalId: { value: "D-2024-0542", confidence: 0.91 },
      },
      numericData: {
        rectalTemp: { value: "38.5", unit: "â„ƒ", confidence: 0.78, range: "35.0-42.0" },
        weight: { value: "12.3", unit: "kg", confidence: 0.94, range: "0-100" },
      },
      checkboxData: {
        appetite: { value: "æ®‹é¤Œ1/3ä»¥ä¸‹", confidence: 0.85, options: ["è‰¯å¥½", "æ®‹é¤Œ1/3ä»¥ä¸‹", "æ®‹é¤Œ2/3ä»¥ä¸‹", "é£Ÿã¹ãªã„"] },
        energy: { value: "ã‚„ã‚„å…ƒæ°—ãªã—", confidence: 0.62, options: ["å…ƒæ°—", "ã‚„ã‚„å…ƒæ°—ãªã—", "å…ƒæ°—ãªã—", "ãã£ãŸã‚Š"] },
        dehydration: { value: "ãªã—", confidence: 0.91, options: ["ãªã—", "è»½åº¦", "ä¸­åº¦", "é‡åº¦"] },
        vomiting: { value: "ãªã—", confidence: 0.89, options: ["ãªã—", "ã‚ã‚Šï¼ˆ1å›ï¼‰", "ã‚ã‚Šï¼ˆè¤‡æ•°å›ï¼‰"] },
        feces: { value: "æ™®é€š", confidence: 0.83, options: ["æ™®é€š", "è»Ÿä¾¿", "ä¸‹ç—¢", "è¡€ä¾¿", "ãªã—"] },
        nasalDischarge: { value: "ãªã—", confidence: 0.95, options: ["ãªã—", "ã‚ã‚Šï¼ˆæ¼¿æ¶²æ€§ï¼‰", "ã‚ã‚Šï¼ˆç²˜æ¶²æ€§ï¼‰", "ã‚ã‚Šï¼ˆè†¿æ€§ï¼‰"] },
        lacrimation: { value: "ãªã—", confidence: 0.93, options: ["ãªã—", "ã‚ã‚Š"] },
        conjunctivitis: { value: "ãªã—", confidence: 0.90, options: ["ãªã—", "è»½åº¦", "é‡åº¦"] },
        eyeDischarge: { value: "ãªã—", confidence: 0.88, options: ["ãªã—", "ã‚ã‚Š"] },
        cough: { value: "ãªã—", confidence: 0.96, options: ["ãªã—", "ã‚ã‚Šï¼ˆè»½åº¦ï¼‰", "ã‚ã‚Šï¼ˆé‡åº¦ï¼‰"] },
        sneezing: { value: "ãªã—", confidence: 0.94, options: ["ãªã—", "ã‚ã‚Š"] },
        abnormalBreathing: { value: "ãªã—", confidence: 0.87, options: ["ãªã—", "ã‚ã‚Š"] },
      },
      notes: { value: "", confidence: 1.0 },
    };

    // Additional sample data for multiple records export
    const sampleScoreSheetDataList = [
      sampleScoreSheetData,
      {
        id: "SS-2026-0120-002",
        basicInfo: {
          date: { value: "2026-01-20", confidence: 0.97 },
          time: { value: "14:45", confidence: 0.95 },
          manager: { value: "ä½è—¤èŠ±å­", confidence: 0.92 },
          animalType: { value: "çŒ«", confidence: 0.99 },
          animalId: { value: "C-2024-0128", confidence: 0.94 },
        },
        numericData: {
          rectalTemp: { value: "38.8", unit: "â„ƒ", confidence: 0.91, range: "35.0-42.0" },
          weight: { value: "4.2", unit: "kg", confidence: 0.96, range: "0-100" },
        },
        checkboxData: {
          appetite: { value: "è‰¯å¥½", confidence: 0.95, options: ["è‰¯å¥½", "æ®‹é¤Œ1/3ä»¥ä¸‹", "æ®‹é¤Œ2/3ä»¥ä¸‹", "é£Ÿã¹ãªã„"] },
          energy: { value: "å…ƒæ°—", confidence: 0.93, options: ["å…ƒæ°—", "ã‚„ã‚„å…ƒæ°—ãªã—", "å…ƒæ°—ãªã—", "ãã£ãŸã‚Š"] },
          dehydration: { value: "ãªã—", confidence: 0.97, options: ["ãªã—", "è»½åº¦", "ä¸­åº¦", "é‡åº¦"] },
          vomiting: { value: "ãªã—", confidence: 0.95, options: ["ãªã—", "ã‚ã‚Šï¼ˆ1å›ï¼‰", "ã‚ã‚Šï¼ˆè¤‡æ•°å›ï¼‰"] },
          feces: { value: "æ™®é€š", confidence: 0.92, options: ["æ™®é€š", "è»Ÿä¾¿", "ä¸‹ç—¢", "è¡€ä¾¿", "ãªã—"] },
          nasalDischarge: { value: "ãªã—", confidence: 0.96, options: ["ãªã—", "ã‚ã‚Šï¼ˆæ¼¿æ¶²æ€§ï¼‰", "ã‚ã‚Šï¼ˆç²˜æ¶²æ€§ï¼‰", "ã‚ã‚Šï¼ˆè†¿æ€§ï¼‰"] },
          lacrimation: { value: "ãªã—", confidence: 0.94, options: ["ãªã—", "ã‚ã‚Š"] },
          conjunctivitis: { value: "ãªã—", confidence: 0.93, options: ["ãªã—", "è»½åº¦", "é‡åº¦"] },
          eyeDischarge: { value: "ãªã—", confidence: 0.91, options: ["ãªã—", "ã‚ã‚Š"] },
          cough: { value: "ãªã—", confidence: 0.97, options: ["ãªã—", "ã‚ã‚Šï¼ˆè»½åº¦ï¼‰", "ã‚ã‚Šï¼ˆé‡åº¦ï¼‰"] },
          sneezing: { value: "ãªã—", confidence: 0.95, options: ["ãªã—", "ã‚ã‚Š"] },
          abnormalBreathing: { value: "ãªã—", confidence: 0.94, options: ["ãªã—", "ã‚ã‚Š"] },
        },
        notes: { value: "", confidence: 1.0 },
      },
      {
        id: "SS-2026-0119-001",
        basicInfo: {
          date: { value: "2026-01-19", confidence: 0.93 },
          time: { value: "09:15", confidence: 0.90 },
          manager: { value: "ç”°ä¸­å¤ªéƒ", confidence: 0.89 },
          animalType: { value: "çŠ¬", confidence: 0.98 },
          animalId: { value: "D-2024-0543", confidence: 0.91 },
        },
        numericData: {
          rectalTemp: { value: "39.1", unit: "â„ƒ", confidence: 0.88, range: "35.0-42.0" },
          weight: { value: "8.7", unit: "kg", confidence: 0.93, range: "0-100" },
        },
        checkboxData: {
          appetite: { value: "æ®‹é¤Œ2/3ä»¥ä¸‹", confidence: 0.82, options: ["è‰¯å¥½", "æ®‹é¤Œ1/3ä»¥ä¸‹", "æ®‹é¤Œ2/3ä»¥ä¸‹", "é£Ÿã¹ãªã„"] },
          energy: { value: "ã‚„ã‚„å…ƒæ°—ãªã—", confidence: 0.79, options: ["å…ƒæ°—", "ã‚„ã‚„å…ƒæ°—ãªã—", "å…ƒæ°—ãªã—", "ãã£ãŸã‚Š"] },
          dehydration: { value: "è»½åº¦", confidence: 0.85, options: ["ãªã—", "è»½åº¦", "ä¸­åº¦", "é‡åº¦"] },
          vomiting: { value: "ã‚ã‚Šï¼ˆ1å›ï¼‰", confidence: 0.87, options: ["ãªã—", "ã‚ã‚Šï¼ˆ1å›ï¼‰", "ã‚ã‚Šï¼ˆè¤‡æ•°å›ï¼‰"] },
          feces: { value: "è»Ÿä¾¿", confidence: 0.84, options: ["æ™®é€š", "è»Ÿä¾¿", "ä¸‹ç—¢", "è¡€ä¾¿", "ãªã—"] },
          nasalDischarge: { value: "ãªã—", confidence: 0.92, options: ["ãªã—", "ã‚ã‚Šï¼ˆæ¼¿æ¶²æ€§ï¼‰", "ã‚ã‚Šï¼ˆç²˜æ¶²æ€§ï¼‰", "ã‚ã‚Šï¼ˆè†¿æ€§ï¼‰"] },
          lacrimation: { value: "ãªã—", confidence: 0.91, options: ["ãªã—", "ã‚ã‚Š"] },
          conjunctivitis: { value: "ãªã—", confidence: 0.89, options: ["ãªã—", "è»½åº¦", "é‡åº¦"] },
          eyeDischarge: { value: "ãªã—", confidence: 0.90, options: ["ãªã—", "ã‚ã‚Š"] },
          cough: { value: "ã‚ã‚Šï¼ˆè»½åº¦ï¼‰", confidence: 0.86, options: ["ãªã—", "ã‚ã‚Šï¼ˆè»½åº¦ï¼‰", "ã‚ã‚Šï¼ˆé‡åº¦ï¼‰"] },
          sneezing: { value: "ã‚ã‚Š", confidence: 0.88, options: ["ãªã—", "ã‚ã‚Š"] },
          abnormalBreathing: { value: "ãªã—", confidence: 0.91, options: ["ãªã—", "ã‚ã‚Š"] },
        },
        notes: { value: "", confidence: 1.0 },
      },
    ];

    const sampleHistory = [
      { id: "SS-2026-0120-001", date: "2026-01-20", time: "14:30", animal: "çŠ¬ D-2024-0542", status: "ç¢ºèªä¸­", confidence: 85 },
      { id: "SS-2026-0120-002", date: "2026-01-20", time: "14:45", animal: "çŒ« C-2024-0128", status: "å®Œäº†", confidence: 94 },
      { id: "SS-2026-0119-001", date: "2026-01-19", time: "09:15", animal: "çŠ¬ D-2024-0543", status: "å®Œäº†", confidence: 91 },
      { id: "SS-2026-0119-002", date: "2026-01-19", time: "09:30", animal: "çŠ¬ D-2024-0544", status: "å®Œäº†", confidence: 89 },
      { id: "SS-2026-0119-003", date: "2026-01-19", time: "10:00", animal: "çŒ« C-2024-0129", status: "å®Œäº†", confidence: 96 },
      { id: "SS-2026-0118-001", date: "2026-01-18", time: "14:00", animal: "çŠ¬ D-2024-0545", status: "ã‚¨ãƒ©ãƒ¼", confidence: 45 },
      { id: "SS-2026-0118-002", date: "2026-01-18", time: "14:15", animal: "çŒ« C-2024-0130", status: "å®Œäº†", confidence: 92 },
    ];

    const recentUploads = [
      { name: "scoresheet_20260120_1430.pdf", date: "2026-01-20 14:32", status: "å‡¦ç†å®Œäº†" },
      { name: "scoresheet_20260120_1445.pdf", date: "2026-01-20 14:47", status: "å‡¦ç†å®Œäº†" },
      { name: "scoresheet_20260119_0915.pdf", date: "2026-01-19 09:18", status: "å‡¦ç†å®Œäº†" },
    ];

    // ============================================================
    // UTILITY COMPONENTS
    // ============================================================
    const ConfidenceBadge = ({ confidence, showValue = true }) => {
      const getColor = (conf) => {
        if (conf >= 0.85) return { bg: "bg-emerald-100", text: "text-emerald-700", border: "border-emerald-300" };
        if (conf >= 0.70) return { bg: "bg-amber-100", text: "text-amber-700", border: "border-amber-300" };
        return { bg: "bg-red-100", text: "text-red-700", border: "border-red-300" };
      };

      const colors = getColor(confidence);
      const percentage = Math.round(confidence * 100);

      return (
        <span className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${colors.bg} ${colors.text} border ${colors.border} ${confidence < 0.70 ? 'confidence-pulse' : ''}`}>
          {showValue && <span className="mono">{percentage}%</span>}
        </span>
      );
    };

    const Button = ({ children, variant = "primary", size = "md", className = "", ...props }) => {
      const variants = {
        primary: "bg-primary-600 hover:bg-primary-700 text-white shadow-sm",
        secondary: "bg-white hover:bg-slate-50 text-slate-700 border border-slate-300 shadow-sm",
        ghost: "hover:bg-slate-100 text-slate-600",
        danger: "bg-red-600 hover:bg-red-700 text-white shadow-sm",
        success: "bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm",
      };

      const sizes = {
        sm: "px-3 py-1.5 text-sm",
        md: "px-4 py-2 text-sm",
        lg: "px-6 py-3 text-base",
      };

      return (
        <button
          className={`inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed ${variants[variant]} ${sizes[size]} ${className}`}
          {...props}
        >
          {children}
        </button>
      );
    };

    const Card = ({ children, className = "", ...props }) => (
      <div className={`bg-white rounded-xl border border-slate-200 shadow-sm ${className}`} {...props}>
        {children}
      </div>
    );

    // ============================================================
    // LAYOUT COMPONENTS
    // ============================================================
    const Sidebar = ({ currentPage, setCurrentPage }) => {
      const menuItems = [
        { id: "upload", label: "ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰", icon: "upload" },
        { id: "review", label: "ãƒ‡ãƒ¼ã‚¿ç¢ºèª", icon: "check" },
        { id: "dashboard", label: "ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰", icon: "grid" },
      ];

      return (
        <aside className="w-64 bg-white border-r border-slate-200 flex flex-col">
          {/* Logo */}
          <div className="h-16 flex items-center px-6 border-b border-slate-200">
            <div className="flex items-center gap-3">
              <div className="w-8 h-8 bg-gradient-to-br from-primary-600 to-primary-700 rounded-lg flex items-center justify-center text-white font-bold text-sm">
                DX
              </div>
              <div>
                <div className="font-semibold text-slate-800 text-sm">ã‚¹ã‚³ã‚¢ã‚·ãƒ¼ãƒˆDX</div>
                <div className="text-xs text-slate-500">å…±ç«‹è£½è–¬</div>
              </div>
            </div>
          </div>

          {/* Navigation */}
          <nav className="flex-1 p-4">
            <ul className="space-y-1">
              {menuItems.map((item) => (
                <li key={item.id}>
                  <button
                    onClick={() => setCurrentPage(item.id)}
                    className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors ${
                      currentPage === item.id
                        ? "bg-primary-50 text-primary-700"
                        : "text-slate-600 hover:bg-slate-50 hover:text-slate-900"
                    }`}
                  >
                    <SimpleIcon type={item.icon} className="text-lg" />
                    {item.label}
                  </button>
                </li>
              ))}
            </ul>
          </nav>

          {/* Footer */}
          <div className="p-4 border-t border-slate-200">
            <div className="flex items-center gap-3 px-4 py-2">
              <div className="w-8 h-8 bg-slate-200 rounded-full flex items-center justify-center text-sm">
                <SimpleIcon type="user" />
              </div>
              <div className="text-sm">
                <div className="font-medium text-slate-800">ç®¡ç†è€…</div>
                <div className="text-xs text-slate-500">admin@kyoritsu.co.jp</div>
              </div>
            </div>
          </div>
        </aside>
      );
    };

    const Header = ({ title, subtitle }) => (
      <header className="h-16 bg-white border-b border-slate-200 flex items-center justify-between px-6">
        <div>
          <h1 className="text-lg font-semibold text-slate-800">{title}</h1>
          {subtitle && <p className="text-sm text-slate-500">{subtitle}</p>}
        </div>
        <div className="flex items-center gap-4">
          <div className="text-sm text-slate-500">
            <span className="mono">2026/01/20 14:35</span>
          </div>
        </div>
      </header>
    );

    // ============================================================
    // PAGE: UPLOAD
    // ============================================================
    const UploadPage = () => {
      const [isDragging, setIsDragging] = useState(false);
      const [uploadProgress, setUploadProgress] = useState(null);

      const handleDrop = (e) => {
        e.preventDefault();
        setIsDragging(false);
        // Simulate upload
        setUploadProgress(0);
        const interval = setInterval(() => {
          setUploadProgress(prev => {
            if (prev >= 100) {
              clearInterval(interval);
              setTimeout(() => setUploadProgress(null), 1000);
              return 100;
            }
            return prev + 10;
          });
        }, 200);
      };

      return (
        <div className="flex-1 flex flex-col">
          <Header title="PDFã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰" subtitle="ã‚¹ã‚³ã‚¢ã‚·ãƒ¼ãƒˆã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦OCRå‡¦ç†ã‚’é–‹å§‹" />

          <main className="flex-1 p-6 overflow-auto">
            <div className="max-w-4xl mx-auto space-y-6 animate-fade-in">
              {/* Dropzone */}
              <Card className="p-8">
                <div
                  className={`border-2 border-dashed rounded-xl p-12 text-center transition-colors ${
                    isDragging ? "border-primary-500 bg-primary-50" : "border-slate-300 hover:border-slate-400"
                  }`}
                  onDragOver={(e) => { e.preventDefault(); setIsDragging(true); }}
                  onDragLeave={() => setIsDragging(false)}
                  onDrop={handleDrop}
                >
                  <div className="flex flex-col items-center gap-4">
                    <div className={`w-16 h-16 rounded-full flex items-center justify-center text-3xl ${
                      isDragging ? "bg-primary-100 text-primary-600" : "bg-slate-100 text-slate-400"
                    }`}>
                      <SimpleIcon type="upload" />
                    </div>
                    <div>
                      <p className="text-lg font-medium text-slate-700">
                        PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—
                      </p>
                      <p className="text-sm text-slate-500 mt-1">
                        ã¾ãŸã¯ä¸‹ã®ãƒœã‚¿ãƒ³ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
                      </p>
                    </div>
                    <Button variant="primary" size="lg" className="mt-2">
                      <SimpleIcon type="file" className="mr-2" />
                      ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
                    </Button>
                    <p className="text-xs text-slate-400 mt-2">
                      å¯¾å¿œå½¢å¼: PDFï¼ˆæ¨å¥¨è§£åƒåº¦: 300dpiä»¥ä¸Šï¼‰
                    </p>
                  </div>
                </div>

                {/* Progress */}
                {uploadProgress !== null && (
                  <div className="mt-6 animate-fade-in">
                    <div className="flex items-center justify-between text-sm mb-2">
                      <span className="text-slate-600">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</span>
                      <span className="font-medium text-primary-600 mono">{uploadProgress}%</span>
                    </div>
                    <div className="h-2 bg-slate-200 rounded-full overflow-hidden">
                      <div
                        className="h-full bg-gradient-to-r from-primary-500 to-primary-600 transition-all duration-300"
                        style={{ width: `${uploadProgress}%` }}
                      />
                    </div>
                  </div>
                )}
              </Card>

              {/* Recent Uploads */}
              <Card>
                <div className="p-4 border-b border-slate-200">
                  <h2 className="font-semibold text-slate-800">æœ€è¿‘ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h2>
                </div>
                <div className="divide-y divide-slate-100">
                  {recentUploads.map((file, i) => (
                    <div key={i} className="flex items-center justify-between p-4 hover:bg-slate-50 transition-colors">
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 bg-red-50 rounded-lg flex items-center justify-center text-red-500">
                          <SimpleIcon type="file" className="text-lg" />
                        </div>
                        <div>
                          <p className="font-medium text-slate-800 text-sm">{file.name}</p>
                          <p className="text-xs text-slate-500">{file.date}</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-3">
                        <span className="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700">
                          <SimpleIcon type="check" className="mr-1" />
                          {file.status}
                        </span>
                        <Button variant="ghost" size="sm">è©³ç´°</Button>
                      </div>
                    </div>
                  ))}
                </div>
              </Card>

              {/* Tips */}
              <Card className="p-4 bg-primary-50 border-primary-200">
                <div className="flex gap-3">
                  <div className="text-primary-600 text-lg">ğŸ’¡</div>
                  <div>
                    <h3 className="font-medium text-primary-800 text-sm">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®ãƒ’ãƒ³ãƒˆ</h3>
                    <ul className="mt-1 text-sm text-primary-700 space-y-1">
                      <li>â€¢ ã‚¹ã‚­ãƒ£ãƒ³æ™‚ã¯300dpiä»¥ä¸Šã®è§£åƒåº¦ã‚’æ¨å¥¨</li>
                      <li>â€¢ å‚¾ãè£œæ­£ã‚’è¡Œã†ã¨OCRç²¾åº¦ãŒå‘ä¸Šã—ã¾ã™</li>
                      <li>â€¢ å½±ã‚„è£å†™ã‚Šã‚’æ¥µåŠ›æ’é™¤ã—ã¦ãã ã•ã„</li>
                    </ul>
                  </div>
                </div>
              </Card>
            </div>
          </main>
        </div>
      );
    };

    // ============================================================
    // PAGE: DATA REVIEW
    // ============================================================
    const ReviewPage = ({ showToast }) => {
      const [data, setData] = useState(sampleScoreSheetData);
      const [editingField, setEditingField] = useState(null);
      const [isExporting, setIsExporting] = useState(false);

      const handleExportExcel = () => {
        setIsExporting(true);
        try {
          const filename = ExcelExporter.exportScoreSheet(data);
          showToast(`Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ã—ã¾ã—ãŸ: ${filename}`, "success");
        } catch (error) {
          showToast("Excelå‡ºåŠ›ã«å¤±æ•—ã—ã¾ã—ãŸ", "error");
          console.error(error);
        } finally {
          setIsExporting(false);
        }
      };

      const handleFieldChange = (category, field, newValue) => {
        setData(prev => ({
          ...prev,
          [category]: {
            ...prev[category],
            [field]: {
              ...prev[category][field],
              value: newValue,
              confidence: 1.0, // Manual edit = 100% confidence
            }
          }
        }));
        setEditingField(null);
      };

      const FieldRow = ({ label, field, category, showRange }) => {
        const fieldData = data[category][field];
        const isEditing = editingField === `${category}.${field}`;

        return (
          <div className={`flex items-center justify-between py-3 px-4 rounded-lg transition-colors ${
            fieldData.confidence < 0.70 ? "bg-red-50" : fieldData.confidence < 0.85 ? "bg-amber-50" : "hover:bg-slate-50"
          }`}>
            <div className="flex items-center gap-3">
              <span className="text-sm text-slate-600 w-28">{label}</span>
              {isEditing ? (
                <input
                  type="text"
                  defaultValue={fieldData.value}
                  autoFocus
                  className="border border-primary-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"
                  onBlur={(e) => handleFieldChange(category, field, e.target.value)}
                  onKeyDown={(e) => e.key === 'Enter' && handleFieldChange(category, field, e.target.value)}
                />
              ) : (
                <span className="font-medium text-slate-800 mono">
                  {fieldData.value}
                  {fieldData.unit && <span className="text-slate-500 ml-1">{fieldData.unit}</span>}
                </span>
              )}
            </div>
            <div className="flex items-center gap-2">
              {showRange && fieldData.range && (
                <span className="text-xs text-slate-400">({fieldData.range})</span>
              )}
              <ConfidenceBadge confidence={fieldData.confidence} />
              <button
                onClick={() => setEditingField(`${category}.${field}`)}
                className="p-1 text-slate-400 hover:text-primary-600 transition-colors"
              >
                <SimpleIcon type="edit" className="text-sm" />
              </button>
            </div>
          </div>
        );
      };

      // è¦³å¯Ÿé …ç›®ã®å€¤ã‚’0, 1, 2ã«å¤‰æ›ã™ã‚‹ãƒãƒƒãƒ—
      const valueToNumericMap = {
        appetite: { "è‰¯å¥½": 0, "æ®‹é¤Œ1/3ä»¥ä¸‹": 1, "æ®‹é¤Œ2/3ä»¥ä¸‹": 2, "é£Ÿã¹ãªã„": 2 },
        energy: { "å…ƒæ°—": 0, "ã‚„ã‚„å…ƒæ°—ãªã—": 1, "å…ƒæ°—ãªã—": 2, "ãã£ãŸã‚Š": 2 },
        dehydration: { "ãªã—": 0, "è»½åº¦": 1, "ä¸­åº¦": 2, "é‡åº¦": 2 },
        vomiting: { "ãªã—": 0, "ã‚ã‚Šï¼ˆ1å›ï¼‰": 1, "ã‚ã‚Šï¼ˆè¤‡æ•°å›ï¼‰": 2 },
        feces: { "æ™®é€š": 0, "è»Ÿä¾¿": 1, "ãªã—": 1, "ä¸‹ç—¢": 2, "è¡€ä¾¿": 2 },
        nasalDischarge: { "ãªã—": 0, "ã‚ã‚Šï¼ˆæ¼¿æ¶²æ€§ï¼‰": 1, "ã‚ã‚Šï¼ˆç²˜æ¶²æ€§ï¼‰": 2, "ã‚ã‚Šï¼ˆè†¿æ€§ï¼‰": 2 },
        lacrimation: { "ãªã—": 0, "ã‚ã‚Š": 1 },
        conjunctivitis: { "ãªã—": 0, "è»½åº¦": 1, "é‡åº¦": 2 },
        eyeDischarge: { "ãªã—": 0, "ã‚ã‚Š": 1 },
        cough: { "ãªã—": 0, "ã‚ã‚Šï¼ˆè»½åº¦ï¼‰": 1, "ã‚ã‚Šï¼ˆé‡åº¦ï¼‰": 2 },
        sneezing: { "ãªã—": 0, "ã‚ã‚Š": 1 },
        abnormalBreathing: { "ãªã—": 0, "ã‚ã‚Š": 1 },
      };

      // æ•°å€¤ã‹ã‚‰å€¤ã¸ã®é€†å¤‰æ›ãƒãƒƒãƒ—ã‚’ç”Ÿæˆ
      const numericToValueMap = {};
      Object.keys(valueToNumericMap).forEach(field => {
        numericToValueMap[field] = {};
        Object.entries(valueToNumericMap[field]).forEach(([val, num]) => {
          if (!(num in numericToValueMap[field])) {
            numericToValueMap[field][num] = val;
          }
        });
      });

      const getNumericValue = (field, value) => valueToNumericMap[field]?.[value] ?? 0;
      const getTextValue = (field, numValue) => numericToValueMap[field]?.[numValue] ?? "";

      const CheckboxFieldRow = ({ label, field }) => {
        const fieldData = data.checkboxData[field];
        const isEditing = editingField === `checkboxData.${field}`;
        const numericValue = getNumericValue(field, fieldData.value);

        // é¸æŠå¯èƒ½ãªæ•°å€¤ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å–å¾—ï¼ˆé‡è¤‡æ’é™¤ï¼‰
        const numericOptions = [...new Set(Object.values(valueToNumericMap[field]))].sort();

        const handleNumericChange = (numVal) => {
          const textVal = getTextValue(field, parseInt(numVal));
          handleFieldChange('checkboxData', field, textVal);
        };

        return (
          <div className={`flex items-center justify-between py-2.5 px-4 rounded-lg transition-colors ${
            fieldData.confidence < 0.70 ? "bg-red-50" : fieldData.confidence < 0.85 ? "bg-amber-50" : "hover:bg-slate-50"
          }`}>
            <div className="flex items-center gap-3">
              <span className="text-sm text-slate-600 w-24">{label}</span>
              {isEditing ? (
                <select
                  defaultValue={numericValue}
                  autoFocus
                  className="border border-primary-300 rounded px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 w-16"
                  onChange={(e) => handleNumericChange(e.target.value)}
                  onBlur={() => setEditingField(null)}
                >
                  {numericOptions.map(num => (
                    <option key={num} value={num}>{num}</option>
                  ))}
                </select>
              ) : (
                <span className={`text-sm font-bold mono w-8 h-8 flex items-center justify-center rounded ${
                  numericValue === 0 ? "bg-emerald-100 text-emerald-700" :
                  numericValue === 1 ? "bg-amber-100 text-amber-700" :
                  "bg-red-100 text-red-700"
                }`}>
                  {numericValue}
                </span>
              )}
            </div>
            <div className="flex items-center gap-2">
              <ConfidenceBadge confidence={fieldData.confidence} />
              <button
                onClick={() => setEditingField(`checkboxData.${field}`)}
                className="p-1 text-slate-400 hover:text-primary-600 transition-colors"
              >
                <SimpleIcon type="edit" className="text-sm" />
              </button>
            </div>
          </div>
        );
      };

      // Calculate overall confidence
      const allConfidences = [
        ...Object.values(data.basicInfo).map(f => f.confidence),
        ...Object.values(data.numericData).map(f => f.confidence),
        ...Object.values(data.checkboxData).map(f => f.confidence),
      ];
      const avgConfidence = allConfidences.reduce((a, b) => a + b, 0) / allConfidences.length;
      const lowConfidenceCount = allConfidences.filter(c => c < 0.85).length;

      return (
        <div className="flex-1 flex flex-col">
          <Header title="ãƒ‡ãƒ¼ã‚¿ç¢ºèªãƒ»è£œæ­£" subtitle={`ID: ${data.id}`} />

          <main className="flex-1 p-6 overflow-auto">
            <div className="flex gap-6 h-full animate-fade-in">
              {/* PDF Preview */}
              <Card className="w-1/3 flex flex-col">
                <div className="p-4 border-b border-slate-200">
                  <h2 className="font-semibold text-slate-800">PDFãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
                </div>
                <div className="flex-1 bg-slate-100 flex items-center justify-center p-4">
                  <div className="bg-white shadow-lg rounded p-8 w-full max-w-xs">
                    <div className="text-center text-slate-400">
                      <SimpleIcon type="file" className="text-5xl mb-4" />
                      <p className="text-sm">scoresheet_20260120_1430.pdf</p>
                      <p className="text-xs text-slate-300 mt-1">1ãƒšãƒ¼ã‚¸</p>
                    </div>
                  </div>
                </div>
                <div className="p-4 border-t border-slate-200 flex gap-2">
                  <Button variant="secondary" size="sm" className="flex-1">
                    <SimpleIcon type="search" className="mr-1" />
                    æ‹¡å¤§
                  </Button>
                  <Button variant="secondary" size="sm" className="flex-1">
                    <SimpleIcon type="download" className="mr-1" />
                    ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                  </Button>
                </div>
              </Card>

              {/* Data Form */}
              <Card className="flex-1 flex flex-col overflow-hidden">
                {/* Status Bar */}
                <div className="p-4 border-b border-slate-200 flex items-center justify-between">
                  <div className="flex items-center gap-4">
                    <h2 className="font-semibold text-slate-800">OCRæŠ½å‡ºãƒ‡ãƒ¼ã‚¿</h2>
                    <div className="flex items-center gap-2 text-sm">
                      <span className="text-slate-500">å…¨ä½“ä¿¡é ¼åº¦:</span>
                      <ConfidenceBadge confidence={avgConfidence} />
                    </div>
                  </div>
                  {lowConfidenceCount > 0 && (
                    <div className="flex items-center gap-2 text-amber-600 text-sm">
                      <SimpleIcon type="alert" />
                      <span>è¦ç¢ºèªé …ç›®: {lowConfidenceCount}ä»¶</span>
                    </div>
                  )}
                </div>

                {/* Form Content */}
                <div className="flex-1 overflow-auto p-4 space-y-6">
                  {/* Basic Info */}
                  <div>
                    <h3 className="text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2">
                      <SimpleIcon type="calendar" />
                      åŸºæœ¬æƒ…å ±
                    </h3>
                    <div className="space-y-1">
                      <FieldRow label="å¹´æœˆæ—¥" field="date" category="basicInfo" />
                      <FieldRow label="æ™‚é–“" field="time" category="basicInfo" />
                      <FieldRow label="ç®¡ç†è€…" field="manager" category="basicInfo" />
                      <FieldRow label="å‹•ç‰©ç¨®" field="animalType" category="basicInfo" />
                      <FieldRow label="å€‹ä½“ID" field="animalId" category="basicInfo" />
                    </div>
                  </div>

                  {/* Numeric Data */}
                  <div>
                    <h3 className="text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2">
                      <SimpleIcon type="thermometer" />
                      æ•°å€¤é …ç›®
                    </h3>
                    <div className="space-y-1">
                      <FieldRow label="ç›´è…¸æ¸©" field="rectalTemp" category="numericData" showRange />
                      <FieldRow label="ä½“é‡" field="weight" category="numericData" showRange />
                    </div>
                  </div>

                  {/* Checkbox Data */}
                  <div>
                    <h3 className="text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2">
                      <SimpleIcon type="check" />
                      è¦³å¯Ÿé …ç›®
                    </h3>
                    <div className="grid grid-cols-2 gap-x-4 gap-y-1">
                      <CheckboxFieldRow label="é£Ÿæ¬²" field="appetite" />
                      <CheckboxFieldRow label="å…ƒæ°—" field="energy" />
                      <CheckboxFieldRow label="è„±æ°´" field="dehydration" />
                      <CheckboxFieldRow label="å˜”å" field="vomiting" />
                      <CheckboxFieldRow label="ç³ä¾¿" field="feces" />
                      <CheckboxFieldRow label="é¼»æ±" field="nasalDischarge" />
                      <CheckboxFieldRow label="æµæ·š" field="lacrimation" />
                      <CheckboxFieldRow label="çµè†œç‚" field="conjunctivitis" />
                      <CheckboxFieldRow label="çœ¼è„‚" field="eyeDischarge" />
                      <CheckboxFieldRow label="ç™ºå’³" field="cough" />
                      <CheckboxFieldRow label="ãã—ã‚ƒã¿" field="sneezing" />
                      <CheckboxFieldRow label="å‘¼å¸éŸ³ç•°å¸¸" field="abnormalBreathing" />
                    </div>
                  </div>
                </div>

                {/* Action Buttons */}
                <div className="p-4 border-t border-slate-200 flex items-center justify-between bg-slate-50">
                  <Button variant="ghost">
                    <SimpleIcon type="x" className="mr-1" />
                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                  </Button>
                  <div className="flex gap-3">
                    <Button variant="secondary">
                      <SimpleIcon type="clock" className="mr-1" />
                      ä¿ç•™
                    </Button>
                    <Button variant="success" onClick={handleExportExcel} disabled={isExporting}>
                      <SimpleIcon type="check" className="mr-1" />
                      {isExporting ? "å‡ºåŠ›ä¸­..." : "ç¢ºå®šã—ã¦Excelå‡ºåŠ›"}
                    </Button>
                  </div>
                </div>
              </Card>
            </div>
          </main>
        </div>
      );
    };

    // ============================================================
    // PAGE: DASHBOARD
    // ============================================================
    const DashboardPage = ({ showToast }) => {
      const [filter, setFilter] = useState("all");
      const [searchQuery, setSearchQuery] = useState("");
      const [isExporting, setIsExporting] = useState(false);

      const handleExportHistory = () => {
        setIsExporting(true);
        try {
          ExcelExporter.exportHistory(filteredHistory, "å‡¦ç†å±¥æ­´");
          showToast("å‡¦ç†å±¥æ­´ã‚’Excelãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã¾ã—ãŸ", "success");
        } catch (error) {
          showToast("Excelå‡ºåŠ›ã«å¤±æ•—ã—ã¾ã—ãŸ", "error");
          console.error(error);
        } finally {
          setIsExporting(false);
        }
      };

      const handleExportAllScoreSheets = () => {
        setIsExporting(true);
        try {
          const filename = ExcelExporter.exportScoreSheet(sampleScoreSheetDataList);
          showToast(`ã‚¹ã‚³ã‚¢ã‚·ãƒ¼ãƒˆ${sampleScoreSheetDataList.length}ä»¶ã‚’Excelã«å‡ºåŠ›ã—ã¾ã—ãŸ`, "success");
        } catch (error) {
          showToast("Excelå‡ºåŠ›ã«å¤±æ•—ã—ã¾ã—ãŸ", "error");
          console.error(error);
        } finally {
          setIsExporting(false);
        }
      };

      const stats = [
        { label: "æœ¬æ—¥ã®å‡¦ç†ä»¶æ•°", value: "12", change: "+3", positive: true },
        { label: "è¦ç¢ºèª", value: "2", change: "-1", positive: true },
        { label: "å¹³å‡ä¿¡é ¼åº¦", value: "89%", change: "+2%", positive: true },
        { label: "ä»Šæœˆã®å‡¦ç†ä»¶æ•°", value: "156", change: "+23", positive: true },
      ];

      const filteredHistory = sampleHistory.filter(item => {
        if (filter === "all") return true;
        if (filter === "pending") return item.status === "ç¢ºèªä¸­";
        if (filter === "completed") return item.status === "å®Œäº†";
        if (filter === "error") return item.status === "ã‚¨ãƒ©ãƒ¼";
        return true;
      }).filter(item => {
        if (!searchQuery) return true;
        return item.id.toLowerCase().includes(searchQuery.toLowerCase()) ||
               item.animal.toLowerCase().includes(searchQuery.toLowerCase());
      });

      const getStatusBadge = (status) => {
        const styles = {
          "ç¢ºèªä¸­": "bg-amber-100 text-amber-700",
          "å®Œäº†": "bg-emerald-100 text-emerald-700",
          "ã‚¨ãƒ©ãƒ¼": "bg-red-100 text-red-700",
        };
        return (
          <span className={`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${styles[status]}`}>
            {status}
          </span>
        );
      };

      return (
        <div className="flex-1 flex flex-col">
          <Header title="ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰" subtitle="å‡¦ç†çŠ¶æ³ã®ç¢ºèªã¨ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ" />

          <main className="flex-1 p-6 overflow-auto">
            <div className="space-y-6 animate-fade-in">
              {/* Stats */}
              <div className="grid grid-cols-4 gap-4">
                {stats.map((stat, i) => (
                  <Card key={i} className="p-5">
                    <p className="text-sm text-slate-500">{stat.label}</p>
                    <div className="flex items-end justify-between mt-2">
                      <span className="text-3xl font-bold text-slate-800 mono">{stat.value}</span>
                      <span className={`text-sm font-medium ${stat.positive ? "text-emerald-600" : "text-red-600"}`}>
                        {stat.change}
                      </span>
                    </div>
                  </Card>
                ))}
              </div>

              {/* History Table */}
              <Card>
                <div className="p-4 border-b border-slate-200 flex items-center justify-between">
                  <h2 className="font-semibold text-slate-800">å‡¦ç†å±¥æ­´</h2>
                  <div className="flex items-center gap-3">
                    {/* Search */}
                    <div className="relative">
                      <input
                        type="text"
                        placeholder="æ¤œç´¢..."
                        value={searchQuery}
                        onChange={(e) => setSearchQuery(e.target.value)}
                        className="pl-9 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent w-48"
                      />
                      <SimpleIcon type="search" className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" />
                    </div>

                    {/* Filter */}
                    <select
                      value={filter}
                      onChange={(e) => setFilter(e.target.value)}
                      className="px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"
                    >
                      <option value="all">ã™ã¹ã¦</option>
                      <option value="pending">ç¢ºèªä¸­</option>
                      <option value="completed">å®Œäº†</option>
                      <option value="error">ã‚¨ãƒ©ãƒ¼</option>
                    </select>

                    {/* Export History */}
                    <Button variant="secondary" onClick={handleExportHistory} disabled={isExporting}>
                      <SimpleIcon type="download" className="mr-2" />
                      {isExporting ? "å‡ºåŠ›ä¸­..." : "å±¥æ­´ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ"}
                    </Button>

                    {/* Export All Score Sheets */}
                    <Button variant="primary" onClick={handleExportAllScoreSheets} disabled={isExporting}>
                      <SimpleIcon type="download" className="mr-2" />
                      {isExporting ? "å‡ºåŠ›ä¸­..." : "ã‚¹ã‚³ã‚¢ã‚·ãƒ¼ãƒˆä¸€æ‹¬å‡ºåŠ›"}
                    </Button>
                  </div>
                </div>

                {/* Table */}
                <div className="overflow-x-auto">
                  <table className="w-full">
                    <thead>
                      <tr className="bg-slate-50">
                        <th className="text-left py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">ID</th>
                        <th className="text-left py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">æ—¥ä»˜</th>
                        <th className="text-left py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">æ™‚é–“</th>
                        <th className="text-left py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">å¯¾è±¡</th>
                        <th className="text-left py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">ä¿¡é ¼åº¦</th>
                        <th className="text-left py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                        <th className="text-left py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">æ“ä½œ</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-slate-100">
                      {filteredHistory.map((item) => (
                        <tr key={item.id} className="hover:bg-slate-50 transition-colors">
                          <td className="py-3 px-4 text-sm font-medium text-primary-600 mono">{item.id}</td>
                          <td className="py-3 px-4 text-sm text-slate-600">{item.date}</td>
                          <td className="py-3 px-4 text-sm text-slate-600 mono">{item.time}</td>
                          <td className="py-3 px-4 text-sm text-slate-800">{item.animal}</td>
                          <td className="py-3 px-4">
                            <ConfidenceBadge confidence={item.confidence / 100} />
                          </td>
                          <td className="py-3 px-4">{getStatusBadge(item.status)}</td>
                          <td className="py-3 px-4">
                            <Button variant="ghost" size="sm">è©³ç´°</Button>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                {/* Pagination */}
                <div className="p-4 border-t border-slate-200 flex items-center justify-between">
                  <p className="text-sm text-slate-500">
                    {filteredHistory.length}ä»¶ä¸­ 1-{filteredHistory.length}ä»¶ã‚’è¡¨ç¤º
                  </p>
                  <div className="flex gap-2">
                    <Button variant="secondary" size="sm" disabled>å‰ã¸</Button>
                    <Button variant="secondary" size="sm" disabled>æ¬¡ã¸</Button>
                  </div>
                </div>
              </Card>

              {/* Confidence Legend */}
              <Card className="p-4">
                <h3 className="text-sm font-semibold text-slate-700 mb-3">ä¿¡é ¼åº¦ã®è¦‹æ–¹</h3>
                <div className="flex gap-6">
                  <div className="flex items-center gap-2">
                    <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-emerald-100 text-emerald-700 border border-emerald-300">85%+</span>
                    <span className="text-sm text-slate-600">è‡ªå‹•ç¢ºå®šï¼ˆé«˜ä¿¡é ¼ï¼‰</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-700 border border-amber-300">70-84%</span>
                    <span className="text-sm text-slate-600">è¦ç¢ºèªï¼ˆä¸­ä¿¡é ¼ï¼‰</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-700 border border-red-300">70%æœªæº€</span>
                    <span className="text-sm text-slate-600">è¦ä¿®æ­£ï¼ˆä½ä¿¡é ¼ï¼‰</span>
                  </div>
                </div>
              </Card>
            </div>
          </main>
        </div>
      );
    };

    // ============================================================
    // MAIN APP
    // ============================================================
    const App = () => {
      const [currentPage, setCurrentPage] = useState("upload");
      const [toast, setToast] = useState(null);

      const showToast = (message, type = "success") => {
        setToast({ message, type });
      };

      const renderPage = () => {
        switch (currentPage) {
          case "upload": return <UploadPage />;
          case "review": return <ReviewPage showToast={showToast} />;
          case "dashboard": return <DashboardPage showToast={showToast} />;
          default: return <UploadPage />;
        }
      };

      return (
        <div className="flex h-screen bg-slate-50">
          <Sidebar currentPage={currentPage} setCurrentPage={setCurrentPage} />
          {renderPage()}
          {toast && (
            <Toast
              message={toast.message}
              type={toast.type}
              onClose={() => setToast(null)}
            />
          )}
        </div>
      );
    };

    // Render
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
