---
title: iPadスコアシート入力アプリ プロダクト仕様書
tags: [project/kyoritsu, product-spec, iPad, smart-device]
created: 2026-02-19
updated: 2026-02-19
status: draft（クライアント確認用）
---

# iPad スコアシート入力アプリ プロダクト仕様書

## 目的

ワクチン効力試験（チャレンジ試験）のスコアシート記入を、紙からiPadでの直接入力に移行する。電子データを原本（ローデータ）とし、厚労省GCP準拠の監査証跡を自動記録する。

---

## 1. ユーザーと利用シーン

### 1.1 ユーザーロール

| ロール | 主な操作 | 想定人数 |
|--------|---------|---------|
| **観察者** | 巡回中にスコア入力・写真撮影 | 5〜10名 |
| **試験責任者** | 試験・スコアシート作成、データ確認・承認 | 1〜2名 |
| **管理者** | ユーザー管理、マスタ設定 | 1名 |

### 1.2 利用環境

| 項目 | 想定 | **要確認** |
|------|------|-----------|
| 利用場所 | 実験棟内（第1実験棟 A室、第2実験棟 B室 等） | 実験棟の数・配置 |
| 手袋着用 | ラテックス手袋を着用した状態での操作 | 手袋の種類 |
| 衛生管理 | iPadの消毒が必要な環境か | 消毒頻度・方法 |
| 照明 | 蛍光灯下（写真撮影に影響） | 撮影環境 |
| 1回の巡回時間 | 30分〜1時間（1試験あたり） | 実測値 |

---

## 2. 画面構成

### 2.1 画面一覧

```
ログイン画面
  ↓
ホーム画面（試験一覧）
  ├─ 試験詳細（個体一覧）
  │    └─ スコア入力画面 ← メイン操作画面
  │         ├─ 写真撮影
  │         └─ 入力確認・保存
  ├─ 本日の観察予定（ショートカット）
  └─ 設定
```

### 2.2 メイン画面: スコア入力

```
┌─────────────────────────────────────────────────────┐
│ ← 戻る    D-006 犬5種 2025-A   Day 5    田中 ▼    │
├─────────────────────────────────────────────────────┤
│                                                     │
│  観察日時: 2025-09-06  09:30  [現在時刻]            │
│                                                     │
│  ┌───────────────────────────────────────────────┐  │
│  │ ①直腸温    [ 39.2 ] ℃        ⚠ 39.0℃超      │  │
│  │ 　体　重    [ 9.85 ] kg                       │  │
│  └───────────────────────────────────────────────┘  │
│                                                     │
│  ┌───────────────────────────────────────────────┐  │
│  │ ②食欲    [0] [±] [1] [2] [3]                 │  │
│  │ ③元気    [0] [±] [1] [2] [3]                 │  │
│  │ ④脱水    [0] [±] [1] [2] [3]                 │  │
│  │ ⑤嘔吐    [0] [±] [1]                         │  │
│  │ ⑥糞便    [0] [±] [1] [2] [3] [4]             │  │
│  └───────────────────────────────────────────────┘  │
│                                                     │
│  ┌───────────────────────────────────────────────┐  │
│  │       左    右                                 │  │
│  │ ⑦鼻汁  [0▼] [0▼]     ⑧流涙  [0▼] [0▼]      │  │
│  │ ⑨眼脂  [0▼] [0▼]     ⑩結膜炎 [0▼] [0▼]     │  │
│  └───────────────────────────────────────────────┘  │
│                                                     │
│  ┌───────────────────────────────────────────────┐  │
│  │ ⑪発咳      [0] [±] [1] [2]                   │  │
│  │ ⑫くしゃみ  [0] [±] [1] [2]                   │  │
│  │ ⑬呼吸音    [0] [1]                            │  │
│  └───────────────────────────────────────────────┘  │
│                                                     │
│  ┌───────────────────────────────────────────────┐  │
│  │ 備考                                          │  │
│  │ [                                           ] │  │
│  └───────────────────────────────────────────────┘  │
│                                                     │
│  [📷 写真を追加 (0枚)]                              │
│                                                     │
│  [ 前の個体 ◀ ]          [ ▶ 次の個体 ]            │
│                                                     │
│           [  保存  ]                                │
│                                                     │
└─────────────────────────────────────────────────────┘
```

---

## 3. 機能要件

### 3.1 スコア入力

| 機能 | 仕様 | 備考 |
|------|------|------|
| 数値入力（体温） | テンキー入力、小数点1桁 | 範囲: 35.0〜42.0 |
| 数値入力（体重） | テンキー入力、小数点2桁 | 範囲: 0.01〜 |
| スコア入力 | ボタンタップで選択（ラジオボタン式） | 各項目の値域に準拠 |
| 左右項目 | 左右それぞれ独立して入力 | ⑦⑧⑨⑩の4項目 |
| 備考欄 | フリーテキスト入力 | 任意 |
| 自動計算 | 臨床スコア合計をリアルタイム表示 | 参考値として表示 |
| **前回値の参照** | 前日の入力値を薄く表示 | 変化の把握を支援 |

### 3.2 入力バリデーション

| チェック | 内容 | タイミング |
|---------|------|-----------|
| 範囲チェック | 体温35.0〜42.0℃、体重0.01kg〜 | 入力即時 |
| スコア値域 | 各項目の最大値を超えていないか | 入力即時 |
| 必須項目 | 観察者名、観察日時 | 保存時 |
| 異常値警告 | 体温≧39.5℃等で⚠表示 | 入力即時 |
| 急変検知 | 前日比で大きな変化がある場合に注意喚起 | 保存時 |
| 未入力チェック | 全項目が空の場合に確認ダイアログ | 保存時 |

### 3.3 写真撮影・添付

| 機能 | 仕様 |
|------|------|
| 撮影 | iPadカメラで撮影、1観察あたり複数枚可 |
| ライブラリ選択 | カメラロールからの選択も可 |
| 異常時の自動促し | 臨床スコアが閾値以上の場合、写真撮影を促すダイアログ |
| メタデータ自動付与 | 個体番号、Day、日時、撮影者を自動で紐付け |
| プレビュー | サムネイル表示、タップで拡大 |
| 保存先 | ローカル保存 → Wi-Fi復帰時にクラウドアップロード |

### 3.4 オフライン対応

| 項目 | 仕様 |
|------|------|
| 入力 | オフラインで全操作可能 |
| ローカル保存 | 端末内にデータ・写真を保存 |
| 同期 | ネットワーク復帰時に自動同期 |
| 競合解決 | タイムスタンプベースで新しいデータを優先（競合時は通知） |
| 同期状態表示 | ステータスバーに同期状態を表示（✓同期済 / ⏳未同期 n件） |

### 3.5 監査証跡（Audit Trail）

GCP査察対応の最重要機能。

| 記録内容 | 詳細 |
|---------|------|
| 操作種別 | INSERT（新規入力）/ UPDATE（修正）/ DELETE（削除） |
| 操作者 | ログインユーザー名 |
| 操作日時 | 端末ローカル時刻 + UTC |
| 変更項目 | 変更されたフィールド名 |
| 変更前の値 | 修正前のデータ |
| 変更後の値 | 修正後のデータ |
| 変更理由 | **修正時は理由の入力を必須とする** |
| 電子署名 | 保存時にパスワード再入力で本人確認 |

### 3.6 ワークフロー

```
観察者: スコア入力 → 保存（電子署名）
         ↓
試験責任者: データ確認 → 承認（電子署名）
         ↓
         ロック状態（以降は修正理由付きの訂正のみ可能）
```

---

## 4. クライアント確認事項（設計上の論点）

### 4.1 デバイス・環境

| # | 確認事項 | 選択肢 | 設計への影響 |
|---|---------|--------|-------------|
| 1 | **iPadの利用形態** | A: 個人専用 / B: 実験室に常備（共有） | 認証方式、データ管理 |
| 2 | **iPad機種** | A: 既存iPad流用 / B: 新規購入（推奨: iPad 第10世代〜） | 対応OS、画面サイズ |
| 3 | **必要台数** | 実験棟ごとに1台？ 観察者ごとに1台？ | 調達コスト、同期設計 |
| 4 | **ネットワーク環境** | A: Wi-Fi常時接続 / B: 一部圏外あり / C: 基本圏外 | オフライン設計の深度 |
| 5 | **防水・耐衝撃ケース** | 必要か？ どの程度の防護か？ | ケース選定・調達 |
| 6 | **手袋操作** | 手袋着用で操作するか？ 手袋の種類は？ | UI部品のサイズ設計 |

### 4.2 入力フォーム設計

| # | 確認事項 | 選択肢 | 設計への影響 |
|---|---------|--------|-------------|
| 7 | **+/- スコアの扱い** | A: 0として扱う / B: 独立した値として記録 / C: 0と1の間の値(0.5等) | データモデル、集計ロジック |
| 8 | **観察項目の可変性** | A: 全試験で共通 / B: 試験ごとにカスタマイズ可能にしたい | フォーム設計の柔軟性 |
| 9 | **入力順序** | A: 項目順に上から下 / B: 個体を横断して同一項目をまとめて入力 | 画面遷移設計 |
| 10 | **紙スコアシートとの併用期間** | A: 即時完全移行 / B: 並行運用期間を設ける | データ二重管理の考慮 |
| 11 | **スコアリング基準の表示** | A: 凡例を常時表示 / B: ?ボタンで都度参照 / C: 不要（熟練者のみ） | 画面レイアウト |

### 4.3 写真撮影

| # | 確認事項 | 選択肢 | 設計への影響 |
|---|---------|--------|-------------|
| 12 | **写真撮影のタイミング** | A: 異常時のみ / B: 毎日全個体 / C: 観察者の判断 | ストレージ容量、業務負荷 |
| 13 | **写真の必須/任意** | A: 異常スコア時は必須 / B: 常に任意 | ワークフロー設計 |
| 14 | **撮影部位のガイド** | 必要か？（例: 「鼻周りを撮影してください」等の指示） | UI設計 |

### 4.4 監査証跡・承認フロー

| # | 確認事項 | 選択肢 | 設計への影響 |
|---|---------|--------|-------------|
| 15 | **電子署名の方式** | A: パスワード再入力 / B: Face ID/Touch ID / C: 不要（ログインで十分） | セキュリティ設計 |
| 16 | **承認フロー** | A: 観察者入力→責任者承認（2段階） / B: 観察者入力のみ（承認不要） / C: 試験終了時に一括承認 | ワークフロー設計 |
| 17 | **修正の権限** | A: 入力者本人のみ修正可 / B: 試験責任者も修正可 / C: 管理者のみ | 権限設計 |
| 18 | **データロック** | A: 承認後はロック（修正不可） / B: 承認後も理由付きで修正可 | データ管理方針 |
| 19 | **修正理由の定型文** | A: 自由入力のみ / B: 選択式（記入ミス・再計測等）＋自由入力 | UI設計 |

### 4.5 データ連携・出力

| # | 確認事項 | 選択肢 | 設計への影響 |
|---|---------|--------|-------------|
| 20 | **Excel出力** | A: 既存フォーマット準拠が必須 / B: 新フォーマットでOK | 帳票開発 |
| 21 | **Dropboxとの連携** | A: 引き続き必要 / B: データ基盤に移行すれば不要 | 外部連携 |
| 22 | **Snowflake連携タイミング** | A: リアルタイム同期 / B: 日次バッチ / C: 手動エクスポート | アーキテクチャ |
| 23 | **印刷機能** | 入力済みスコアシートのPDF印刷は必要か？ | 帳票開発 |

### 4.6 運用

| # | 確認事項 | 選択肢 | 設計への影響 |
|---|---------|--------|-------------|
| 24 | **ユーザー管理** | A: 固定アカウント / B: Active Directory連携 / C: 共立製薬の既存認証基盤 | 認証設計 |
| 25 | **試験マスタの作成** | A: アプリ内で作成 / B: 管理画面（PC）で作成 / C: Excelインポート | 管理機能の範囲 |
| 26 | **対象動物種** | 犬・猫のみ？ 将来的に他の動物種にも拡張？ | データモデルの拡張性 |
| 27 | **1日の観察回数** | 1日1回？ 複数回（朝・夕）？ | 入力フロー設計 |

---

## 5. 技術構成（案）

### 5.1 アーキテクチャ

```
┌──────────────────────────┐      ┌──────────────────────────┐
│      iPad アプリ          │      │      クラウド             │
│                          │      │                          │
│  ┌──────────────────┐    │      │  ┌──────────────────┐    │
│  │  入力フォーム     │    │      │  │   API Server     │    │
│  │  写真撮影        │    │ ←──→ │  │  (Cloud Run)     │    │
│  │  オフラインDB    │    │ sync  │  │                  │    │
│  │  (SQLite/Realm)  │    │      │  └────────┬─────────┘    │
│  └──────────────────┘    │      │           │              │
│                          │      │  ┌────────▼─────────┐    │
│  ┌──────────────────┐    │      │  │  Cloud SQL /     │    │
│  │  監査証跡ログ    │    │      │  │  Firestore       │    │
│  │  (ローカル)      │    │      │  │  (マスターDB)    │    │
│  └──────────────────┘    │      │  └────────┬─────────┘    │
│                          │      │           │              │
└──────────────────────────┘      │  ┌────────▼─────────┐    │
                                  │  │  Cloud Storage   │    │
                                  │  │  (写真保存)      │    │
                                  │  └────────┬─────────┘    │
                                  │           │              │
                                  │  ┌────────▼─────────┐    │
                                  │  │  Snowflake       │    │
                                  │  │  (分析基盤)      │    │
                                  │  └──────────────────┘    │
                                  │                          │
                                  └──────────────────────────┘
```

### 5.2 技術選定（案）

| レイヤー | 候補 | 理由 |
|---------|------|------|
| **iPad アプリ** | A: Swift (ネイティブ) / B: Flutter / C: PWA | 後述 |
| **バックエンド** | Cloud Run (Python/FastAPI) | GCP既存利用、スケーラブル |
| **データベース** | Cloud SQL (PostgreSQL) | 監査証跡、トランザクション |
| **写真ストレージ** | Cloud Storage | 大容量、低コスト |
| **分析基盤** | Snowflake | 既存利用中 |

### 5.3 アプリ技術の選択肢

| 方式 | メリット | デメリット | 推奨度 |
|------|---------|-----------|--------|
| **Swift (ネイティブ)** | 最高のUX、カメラ制御、オフライン安定 | iOS専用、開発コスト高 | PoC後に本開発で検討 |
| **Flutter** | iOS/Android両対応、開発効率 | ネイティブ比で若干のUX差 | 将来Android対応なら |
| **PWA (Web)** | 開発最速、端末非依存 | オフライン制限、カメラ制約 | **PoC向き** |

**推奨**: PoC = PWA（Web）で素早く検証 → 本開発 = Swift or Flutter

---

## 6. セキュリティ要件（GCP準拠）

| 要件 | 対応方針 |
|------|---------|
| **認証** | ユーザーID + パスワード。自動ログアウト（設定可能） |
| **権限管理** | ロールベース（観察者 / 試験責任者 / 管理者） |
| **通信暗号化** | HTTPS (TLS 1.3) |
| **端末データ暗号化** | iOS標準暗号化 + アプリレベル暗号化 |
| **監査証跡** | 全操作を記録、改ざん不可（追記のみ） |
| **バックアップ** | 日次自動バックアップ、30日保持 |
| **データ保持期間** | 規制要件に準拠（試験終了後 X 年） |

---

## 7. 開発スケジュール（案）

```
Phase 0: 仕様確定           [2週間]
├─ クライアントとの確認事項すり合わせ
├─ UI/UXプロトタイプ（Figma）
└─ 技術検証

Phase 1: PoC開発            [4〜6週間]
├─ PWAベースの入力フォーム
├─ 主要項目の入力・保存
├─ オフライン基本動作
├─ 写真撮影（基本）
└─ 現場での試用・フィードバック収集

Phase 2: 本開発             [3〜4ヶ月]
├─ ネイティブ or Flutter（PoCの結果で判断）
├─ 全機能実装
├─ 監査証跡・承認フロー
├─ Snowflake連携
├─ Excel出力
└─ セキュリティ対応

Phase 3: 導入・運用         [1ヶ月]
├─ ユーザートレーニング
├─ 並行運用（紙 + iPad）
├─ 運用マニュアル
└─ 本番稼働
```

---

## 8. 費用概算（参考）

| 項目 | 概算 | 備考 |
|------|------|------|
| **PoC開発** | 200〜400万円 | PWAベース、主要機能のみ |
| **本開発** | 800〜1,500万円 | ネイティブ、全機能、GCP対応 |
| **iPad調達** | 5〜15万円/台 | iPad第10世代 + ケース |
| **クラウド月額** | 3〜8万円/月 | Cloud Run + Cloud SQL + Storage |
| **保守運用** | 10〜20万円/月 | バグ修正、小改修、監視 |

---

## 9. 関連資料

- [[2026-02-データモデル設計-スコアシート]] - 既存データモデル
- [[2026-02-提案整理-共立製薬-スコアシートDX]] - 提案全体像
- [[2026-02-データ基盤メリット整理-共立製薬]] - メリット整理（2-2, 2-3に直結）
- [[スコアシート自動化設計案]] - 旧OCR方式（参考）

---

## 付録A: スコアリング基準（凡例）

入力フォームのヘルプ表示用。詳細は [[2026-02-データモデル設計-スコアシート]] を参照。

| 項目 | 値域 | 基準 |
|------|------|------|
| ②食欲 | 0, ±, 1, 2, 3 | 0:正常 → 3:不食 |
| ③元気 | 0, ±, 1, 2, 3 | 0:正常 → 3:死亡 |
| ④脱水 | 0, ±, 1, 2, 3 | 0:正常 → 3:冷感・起立不能 |
| ⑤嘔吐 | 0, ±, 1 | 0:なし / ±:吐出 / 1:嘔吐 |
| ⑥糞便 | 0, ±, 1, 2, 3, 4 | 0:正常 → 4:血便 |
| ⑦鼻汁 | 0, ±, 1, 3, 5 | 0:なし → 5:膿性鼻汁（左右別） |
| ⑧流涙 | 0, ±, 1 | 0:なし → 1:流涙（左右別） |
| ⑨眼脂 | 0, ±, 1, 2 | 0:なし → 2:膿性（左右別） |
| ⑩結膜炎 | 0, ±, 1, 2 | 0:なし → 2:重度（左右別） |
| ⑪発咳 | 0, ±, 1, 2 | 0:なし → 2:頻発 |
| ⑫くしゃみ | 0, ±, 1, 2 | 0:なし → 2:頻発 |
| ⑬呼吸音異常 | 0, 1 | 0:なし / 1:あり |

## 付録B: 確認事項チェックリスト（MTG用）

クライアントとのすり合わせ時に使用。

- [ ] デバイス: iPad機種・台数・利用形態（個人/共有）
- [ ] 環境: ネットワーク（Wi-Fi有無）、手袋操作、衛生要件
- [ ] +/- スコアの扱い方針
- [ ] 観察項目の固定/可変
- [ ] 写真撮影ルール（いつ・必須/任意）
- [ ] 電子署名の方式
- [ ] 承認フロー（2段階？）
- [ ] 修正権限とデータロック方針
- [ ] Excel出力のフォーマット要件
- [ ] Dropbox連携の要否
- [ ] ユーザー管理方式
- [ ] 対象動物種の範囲
- [ ] 1日の観察回数
- [ ] 並行運用期間の有無
- [ ] PoC対象（拠点・試験・期間）
